---
tags:
  - Studies
  - Table
  - Networking
  - Commands
  - Template
  - CyberSecurity
  - CCNA
cssclasses:
  - commands
---
DHCP implementation automates and simplifies the dynamic assignment of IP addresses and network configuration parameters to devices within a network, enhancing efficiency and reducing manual configuration overhead.

## Configuring DHCPv4

| Mode          | Command                                                        | Description                                                                   | Variables `{}` or Options `[]`                                                                                                                                                                                                                                               |
| :------------ | :------------------------------------------------------------- | :---------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `config`      | `ip dhcp excluded-address [{ip-addr} / {ip-addr1} {ip-addr2}]` | Sets addresses to be excluded from the DHCP pool (can be run multiple times). | `{ip-addr}` is the single IP address you want to exclude from the pool. Used instead of the following variables. `{ip-addr1}` is the start of the range you want to exclude from the DHCP pool. `{ip-addr2}` is the end of the range you want to exclude from the DHCP pool. |
| `config`      | `ip dhcp pool {name}`                                          | Configures a DHCP address pool.                                               | `{name}` is the desired name for the DHCP pool.                                                                                                                                                                                                                              |
| `dhcp-config` | `network {network} {mask}`                                     | Configures the address space for the DHCP pool.                               | `{network}` is the desired network address for the DHCP pool range. `{mask}` is the associated subnet mask.                                                                                                                                                                  |
| `dhcp-config` | `dns {addr}`                                                   | Sets the DNS server for the DHCP pool.                                        | `{addr}` is the IP address of the DHCP server.                                                                                                                                                                                                                               |
| `dhcp-config` | `domain-name {fqdn}`                                           | Sets the domain name for the DHCP pool (if applicable).                       | `{fqdn}` is the domain name to use for the DHCP pool.                                                                                                                                                                                                                        |
| `dhcp-config` | `default-router {addr}`                                        | Sets the default gateway for the DHCP server.                                 | `{addr}` is the IP address of the default gateway / router interface for the LAN.                                                                                                                                                                                            |
| `dhcp-config` | `lease [{days} {hrs} {mins} / infinite]`                       | Sets the lease period for leased addresses.                                   | `{days} {hrs} {mins}` is the time period to lease addresses for e.g. `8 4 30`. `{infinite}` can be used instead of the previous variable to set a infinite lease period.                                                                                                     |
| `config`      | `clear ip dhcp server statistics`                              | Clears DHCP statistics. Optional.                                             | N/A                                                                                                                                                                                                                                                                          |

## Configuring DHCPv6

| Mode          | Command                                                                                      | Description                                             | Variables `{}` or Options `[]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| :------------ | :------------------------------------------------------------------------------------------- | :------------------------------------------------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `config`      | `ipv6 dhcp pool {name}`                                                                      | Configures a DHCP address pool.                         | `{name}` is the desired name for the DHCP pool.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| `config-dhcp` | `address prefix {prefix}{length} lifetime [{sec} / infinite] [preferred [{sec} / infinite]]` | Configures the DHCP pool range.                         | `{prefix}` is the desired pool [[IPv6]] network prefix. `{length}` is the desired pool IPv6 prefix length (e.g. /64). `{sec}` is the lease lifetime of the address in seconds. `[infinite]` can be used in place of seconds to specify an infinite lease. `[preferred [{sec} / infinite]]` this section is optional. `{sec}` and `[infinite]` are as above, but the entire section allows you to specify a shorter period than the overall lease time after which the device should begin to look for a new lease address. Worst case scenario it can retain it's current lease until the 'lifetime' period is over. |
| `dhcp-config` | `dns {addr}`                                                                                 | Sets the DNS server for the DHCP pool.                  | `{addr}` is the IP address of the DHCP server.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| `dhcp-config` | `domain-name {fqdn}`                                                                         | Sets the domain name for the DHCP pool (if applicable). | `{fqdn}` is the domain name to use for the DHCP pool.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `dhcp-config` | `default-router {addr}`                                                                      | Sets the default gateway for the DHCP server.           | `{addr}` is the IP address of the default gateway / router interface for the LAN.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `dhcp-config` | `lease [{days} {hrs} {mins} / infinite]`                                                     | Sets the lease period for leased addresses.             | `{days} {hrs} {mins}` is the time period to lease addresses for e.g. `8 4 30`. `{infinite}` can be used instead of the previous variable to set a infinite lease period.                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| `config`      | `interface {int}`                                                                            | Enters interface config mode.                           | `{int}` is the interface name of the desired interface. This should be the one facing the client devices in the same [[LANs\|LAN]].                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `config-if`   | `ipv6 dhcp server {name}`                                                                    | Sets the interface as a DHCPv6 server.                  | `{name}` is the name of the DHCPv6 address pool you just created. Make sure you have set an IPv6 address on the interface before doing this step.                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |

## Configuring a DHCPv4 Relay

| Mode        | Command                    | Description                                                                    | Variables `{}` or Options `[]`                                                                                                      |
| :---------- | :------------------------- | :----------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------- |
| `config`    | `interface {int}`          | Enters interface config mode.                                                  | `{int}` is the interface name of the desired interface. This should be the one facing the client devices in the same [[LANs\|LAN]]. |
| `config-if` | `ip helper-address {addr}` | Sets the interface as a DHCP relay and sets the IP address of the DHCP server. | `{addr}` is the IP address of the external DHCP server.                                                                             |

## Configuring a DHCPv6 Relay

| Mode         | Command                                         | Description                                                                    | Variables `{}` or Options `[]`                                                                                                                                     |
| :----------- | :---------------------------------------------- | :----------------------------------------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `config`     | `interface {int}`                               | Enters interface config mode.                                                  | `{int}` is the interface name of the desired interface. This should be the one facing the client devices in the same [[LANs\|LAN]].                                |
| `config-int` | `ipv6 dhcp relay destination {addr} {exit-int}` | Sets the interface as a DHCP relay and sets the IP address of the DHCP server. | `{addr}` is the IPv6 address of the external DHCP server. `{exit-int}` is the exit interface from the router acting as the relay towards the external DHCP server. |

## Configuring a Router as a DHCP Client

| Mode        | Command           | Description                                             | Variables `{}` or Options `[]`                          |
| :---------- | :---------------- | :------------------------------------------------------ | :------------------------------------------------------ |
| `config`    | `interface {int}` | Enters interface config mode.                           | `{int}` is the interface name of the desired interface. |
| `config-if` | `ip address dhcp` | Sets the interface to look to DHCP for it's IP address. | N/A                                                     |

## Configuring DHCP Snooping

Use the following steps to enable DHCP Spoofing. You can find information of DHCP Spoofing [[DHCP Attacks#DHCP Attack Mitigation|here]].

1. Enable DHCP snooping.
2. Mark trusted ports as trusted.
3. Limit the number of DHCP discovery messages that can be received per second on untrusted ports.
4. Enable DHCP snooping by [[VLANs|VLAN]], or by a range of VLANs.

| Mode        | Command                             | Description                                               | Variables `{}` or Options `[]`                                                                         |
| :---------- | :---------------------------------- | :-------------------------------------------------------- | :----------------------------------------------------------------------------------------------------- |
| `config`    | `ip dhcp snooping`                  | Enables DHCP Snooping on the device.                      | N/A                                                                                                    |
| `config-if` | `ip dhcp snooping trust`            | Sets the interface (or interface range) as trusted ports. | N/A                                                                                                    |
| `config-if` | `ip dhcp snooping limit rate {num}` | Limits the permissible number of DHCP discovery messages. | `{num}` is the number of DHCP discovery messages allowed per second (applies to untrusted ports only). |
| `config`    | `ip dhcp snooping vlan {vlans}`     | Enables DHCP Snooping by VLAN or range of VLANs.          | `{vlans}` are comma separated (if multiple) VLAN numbers. Like this: `5`, or if multiple, `5,10,15`.   |

## Show Commands

| Command                          | Description                                                               | Variables `{}` or Options `[]`    |
| :------------------------------- | :------------------------------------------------------------------------ | :-------------------------------- |
| `show ip dhcp server statistics` | Displays DHCP server statistics.                                          | N/A                               |
| `show ip dhcp binding`           | Displays DHCP address bindings.                                           | N/A                               |
| `show ipv6 dhcp interface {int}` | Shows information about the DHCPv6 configuration on a specific interface. | `{int}` is the desired interface. |
| `show ipv6 dhcp pool`            | Displays information about IPv6 DHCP pools.                               | N/A                               |
| `show ipv6 dhcp binding`         | Shows a list of DHCPv6 address bindings.                                  | N/A                               |
| `show ip dhcp snooping`          | Shows the DHCP snooping configuration.                                    | N/A                               |
| `show ip dhcp snooping binding`  | Shows the clients that have received DHCP information.                    | N/A                               |